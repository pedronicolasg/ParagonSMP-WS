<?php
$datapacks = array(
  array(
    "nome" => "Alien End",
    "tipo" => "Geração de mundo",
    "imagem" => "https://cdn.modrinth.com/data/E8kMzoSt/b03b2438e9dc7c0f54ca3a89748bd48429f7ab78.png",
    "link" => "https://modrinth.com/datapack/alien-end/"
  ),
  array(
    "nome" => "BlazeandCave's Advancements Pack",
    "tipo" => "Mecânica de jogo",
    "imagem" => "https://cdn.modrinth.com/data/VoVJ47kN/88a39593e6ef876d0a22ebb3fcfa398c223bea3c.png",
    "link" => "https://modrinth.com/datapack/blazeandcaves-advancements-pack"
  ),
  array(
    "nome" => "Blossom Blade",
    "tipo" => "Geração de mundo",
    "imagem" => "https://cdn.modrinth.com/data/UMmSTwE0/0d56baf5966c5bc40aa747d4afa586d54bcb8e20.png",
    "link" => "https://modrinth.com/datapack/blossom-blade"
  ),
  array(
    "nome" => "Craftable Saddle",
    "tipo" => "Utilidade",
    "imagem" => "https://cdn.modrinth.com/data/PamPmbXh/fff9cc53983d5dc5d2ac054d00d5dc29a63be659.png",
    "link" => "https://modrinth.com/datapack/piseks-craftable-saddle"
  ),
  array(
    "nome" => "Crafting+",
    "tipo" => "Mecânica de jogo",
    "imagem" => "https://cdn.modrinth.com/data/sjUk6lfU/4d1dead4342e30cd8110ca0c39f83f53964bfda2.png",
    "link" => "https://modrinth.com/datapack/crafting+"
  ),
  array(
    "nome" => "Dimension Detector",
    "tipo" => "Utilidade",
    "imagem" => "https://cdn.modrinth.com/data/u4lzJTkX/b6259b220ee67c0a67e5b9c3fc86766a04b3f6d0.png",
    "link" => "https://modrinth.com/datapack/dimension-detector"
  ),
  array(
    "nome" => "Dungeons and Taverns",
    "tipo" => "Geração de mundo",
    "imagem" => "https://cdn.modrinth.com/data/tpehi7ww/d3819bdb14026e23a9d48b0cc0be99a1a25ea2b5.png",
    "link" => "https://modrinth.com/datapack/dungeons-and-taverns"
  ),
  array(
    "nome" => "Dungeons and Taverns Stronghold Rework",
    "tipo" => "Geração de mundo",
    "imagem" => "https://cdn.modrinth.com/data/rYocd2LE/8a25c21f59d55ae0a7ff05c3624ccf73f4d9ea88.png",
    "link" => "https://modrinth.com/datapack/dungeons-and-taverns-stronghold-rework"
  ),/*
  array(
    "nome" => "Dynamic Torches",
    "tipo" => "Mecânica de jogo",
    "imagem" => "https://cdn.modrinth.com/data/AK1n0IqM/12373fa01f6b978d0932e5556ac6f51b4b785d6d.jpeg",
    "link" => "https://modrinth.com/datapack/dynamic-torches"
  ),*/
  array(
    "nome" => "Explorify",
    "tipo" => "Geração de mundo",
    "imagem" => "https://cdn.modrinth.com/data/HSfsxuTo/83a6782813afa68c84b35886ccb0a23317a36e1a.jpeg",
    "link" => "https://modrinth.com/datapack/explorify"
  ),
  array(
    "nome" => "Hearts",
    "tipo" => "Geração de mundo",
    "imagem" => "https://cdn.modrinth.com/data/XCIMrYn0/e0349d4c25d734ff921c802ec298a556af3ffc1a.png",
    "link" => "https://modrinth.com/datapack/hearts"
  ),
  array(
    "nome" => "Hopo Better Mineshaft",
    "tipo" => "Geração de mundo",
    "imagem" => "https://cdn.modrinth.com/data/9IxCUYAP/0e8ba1e1a31d35b81767e3a8549166e4a771731c.png",
    "link" => "https://modrinth.com/datapack/hopo-better-mineshaft"
  ),
  array(
    "nome" => "Hopo Better Ruined Portals",
    "tipo" => "Geração de mundo",
    "imagem" => "https://cdn.modrinth.com/data/hIpLSyga/4c724d4770f6698c60f59cdf771b4c050b654eaa.png",
    "link" => "https://modrinth.com/datapack/hopo-better-ruined-portals"
  ),/*
  array(
    "nome" => "Simple Damage Indicator",
    "tipo" => "Mecânica de jogo",
    "imagem" => "https://cdn.modrinth.com/data/yVX17p4k/17d99f91560aff9c4db355a04abfde3909f5098e.png",
    "link" => "https://modrinth.com/datapack/simple-damage-indicator"
  ),*/
  array(
    "nome" => "Tectonic",
    "tipo" => "Geração de mundo",
    "imagem" => "https://cdn.modrinth.com/data/lWDHr9jE/9459286c7225ed66c57201881c12e8d1bb8fd2ce.png",
    "link" => "https://modrinth.com/datapack/tectonic"
  ),
  array(
    "nome" => "Towers of the Wild: Reworked",
    "tipo" => "Geração de mundo",
    "imagem" => "https://cdn.modrinth.com/data/iqOgCgNa/42194ca84979c6e6112e86192c00dfb2a6c94d8b.png",
    "link" => "https://modrinth.com/datapack/towers-of-the-wild-reworked"
  ),
  array(
    "nome" => "True Ending: Ender Dragon Overhaul",
    "tipo" => "Mobs",
    "imagem" => "https://cdn.modrinth.com/data/MCnBYP0b/19e79e0859e608cdb1cba8052da133bf68a3e803.png",
    "link" => "https://modrinth.com/datapack/true-ending"
  ),
  array(
    "nome" => "Vanilla Refresh",
    "tipo" => "Mecânica de jogo",
    "imagem" => "https://cdn.modrinth.com/data/gWO6Zqey/01b050ad1da559a0e5f2dfa322ffab4991d56f49.png",
    "link" => "https://modrinth.com/datapack/vanilla-refresh"
  ),
  array(
    "nome" => "Veinminer",
    "tipo" => "Mecânica de jogo",
    "imagem" => "https://cdn.modrinth.com/data/OhduvhIc/f9c333a18b2c11a5fb063de8e86dba8b76094c66.png",
    "link" => "https://modrinth.com/datapack/veinminer"
  ),
  array(
    "nome" => "When Dungeons Arise",
    "tipo" => "Geração de mundo",
    "imagem" => "https://media.forgecdn.net/avatars/thumbnails/405/21/256/256/637616382422917614.png",
    "link" => "https://www.planetminecraft.com/data-pack/dungeons-arise-datapack-1-19-4-1-20-4/"
  )
);

$plugins = array(
  array(
    "nome" => "AuthMeReloaded",
    "tipo" => "Spigot",
    "imagem" => "https://www.spigotmc.org/data/resource_icons/6/6269.jpg",
    "link" => "https://www.spigotmc.org/resources/authmereloaded.6269"
  ),
  array(
    "nome" => "DiscordSRV",
    "tipo" => "Chat",
    "imagem" => "https://www.spigotmc.org/data/resource_icons/18/18494.jpg",
    "link" => "https://www.spigotmc.org/resources/discordsrv.18494"
  ),
  /*array(
    "nome" => "GeyserMC",
    "tipo" => "Mecânica de jogo",
    "imagem" => "https://geysermc.org/img/geyser.png",
    "link" => "https://geysermc.org/"
  ),
  array(
    "nome" => "GeyserSkinManager",
    "tipo" => "Utilidade",
    "imagem" => "https://static.spigotmc.org/styles/spigot/xenresource/resource_icon.png",
    "link" => "https://www.spigotmc.org/resources/geyserskinmanager.88607/"
  ),*/
  array(
    "nome" => "Graves",
    "tipo" => "Mecânica de jogo",
    "imagem" => "https://www.spigotmc.org/data/resource_icons/74/74208.jpg",
    "link" => "https://www.spigotmc.org/resources/graves.74208/"
  ),
  array(
    "nome" => "LaggRemoverPlus",
    "tipo" => "Utilidade",
    "imagem" => "https://www.curseforge.com/images/flame.svg",
    "link" => "https://www.curseforge.com/minecraft/bukkit-plugins/laggremoverplus"
  ),
  array(
    "nome" => "LuckPerms",
    "tipo" => "Universal",
    "imagem" => "https://www.spigotmc.org/data/resource_icons/28/28140.jpg",
    "link" => "https://www.spigotmc.org/resources/luckperms.28140/"
  ),
  array(
    "nome" => "PlaceholderAPI",
    "tipo" => "Utilidade",
    "imagem" => "https://www.spigotmc.org/data/resource_icons/6/6245.jpg",
    "link" => "https://www.spigotmc.org/resources/placeholderapi.6245/"
  ),
  array(
    "nome" => "PVP Stats",
    "tipo" => "Utilidade",
    "imagem" => "https://static.spigotmc.org/styles/spigot/xenresource/resource_icon.png",
    "link" => "https://www.spigotmc.org/resources/pvp-stats.59124/"
  ),
  /*
  array(
    "nome" => "Simple Voice Chat",
    "tipo" => "Social",
    "imagem" => "https://cdn.modrinth.com/data/9eGKb6K1/icon.png",
    "link" => "https://modrinth.com/plugin/simple-voice-chat/",
    "requisitos" => "https://modrinth.com/plugin/simple-voice-chat/version/fabric-1.20.4-2.5.15"
  ),
  */
  array(
    "nome" => "Simple Tpa",
    "tipo" => "Utilidade",
    "imagem" => "https://www.spigotmc.org/data/resource_icons/64/64270.jpg",
    "link" => "https://www.spigotmc.org/resources/simple-tpa.64270/"
  ),
  array(
    "nome" => "SimpleClans",
    "tipo" => "Social",
    "imagem" => "https://cdn.modrinth.com/data/quLDfyDl/60f33c74bf826004fc46a2712dde940cfbd4418c.png",
    "link" => "https://modrinth.com/plugin/simpleclans"
  ),
  array(
    "nome" => "SkinsRestorer",
    "tipo" => "Utilidade",
    "imagem" => "https://skinsrestorer.net/logo.png",
    "link" => "https://skinsrestorer.net/"
  ),
  array(
    "nome" => "Spark",
    "tipo" => "Utilidade",
    "imagem" => "https://www.spigotmc.org/data/resource_icons/57/57242.jpg",
    "link" => "https://www.spigotmc.org/resources/spark.57242/"
  ),/*
  array(
    "nome" => "ViaVersion",
    "tipo" => "Utilidade",
    "imagem" => "https://cdn.modrinth.com/data/P1OZGk5p/15d70082c9e487847aa44061225395edeb282fb1.png",
    "link" => "https://modrinth.com/plugin/viaversion"
  ),*/
);

$resourcepacks = array(
  array(
    "nome" => "Enchant Icons",
    "tipo" => "GUI<br>(Java)",
    "imagem" => "https://cdn.modrinth.com/data/6vhHOIKw/0e65c5452472a00c5bb4c3b0d00d64d0e977e41a.gif",
    "link" => "https://modrinth.com/resourcepack/enchant-icons-countxd"
  ),
  array(
    "nome" => "Shield Corrections",
    "tipo" => "Items<br>(Java/BedRock)",
    "imagem" => "https://cdn.modrinth.com/data/gmX1HqJY/82796037b31d4bcbbaca23d7828fe622800d2c1c.png",
    "link" => "https://modrinth.com/resourcepack/shield-corrections"
  ),
  array(
    "nome" => "Unique Dark",
    "tipo" => "GUI<br>(Java)",
    "imagem" => "https://cdn.modrinth.com/data/BaY1UdGV/7bf4b7e758cf26b5cce62a71f9be17feafe5a0de.png",
    "link" => "https://modrinth.com/resourcepack/unique-dark"
  ),
);

$datapacks = array_filter($datapacks, function ($datapack) {
  return !empty($datapack['nome']) && !empty($datapack['tipo']) && !empty($datapack['imagem']) && !empty($datapack['link']);
});

$plugins = array_filter($plugins, function ($plugin) {
  return !empty($plugin['nome']) && !empty($plugin['tipo']) && !empty($plugin['imagem']) && !empty($plugin['link']);
});

$resourcepacks = array_filter($resourcepacks, function ($resourcepack) {
  return !empty($resourcepack['nome']) && !empty($resourcepack['tipo']) && !empty($resourcepack['imagem']) && !empty($resourcepack['link']);
});

function generateRequirementsButton($item)
{
  if (isset($item['requisitos'])) {
    echo '<a href="' . $item['requisitos'] . '" class="button is-danger">';
    echo '<span class="icon"><i class="fas fa-info-circle"></i></span>';
    echo '<span>Requisitos</span>';
    echo '</a>';
  }
}

// Função para contar os itens
function countItems($items)
{
  return count($items);
}

$numDatapacks = countItems($datapacks);
$numPlugins = countItems($plugins);
$numResourcepacks = countItems($resourcepacks);

require_once 'conn.php';
require_once 'UI.php';

$UI = new UI($conn);
?>

<div class="mb-8">
  <div class="sm:hidden">
    <label for="resourceTabs" class="sr-only">Select a resource type</label>
    <select id="resourceTabs" name="resourceTabs" class="block w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500">
      <option>Datapacks (<?php echo $numDatapacks; ?>)</option>
      <option>Plugins (<?php echo $numPlugins; ?>)</option>
      <option>Resource Packs (<?php echo $numResourcepacks; ?>)</option>
    </select>
  </div>
  <div class="hidden sm:block">
    <nav class="flex space-x-4" aria-label="Tabs">
      <button class="px-3 py-2 text-sm font-medium text-gray-500 rounded-md hover:text-gray-700 hover:bg-gray-50 active" aria-current="page">
        Datapacks (<?php echo $numDatapacks; ?>)
      </button>
      <button class="px-3 py-2 text-sm font-medium text-gray-500 rounded-md hover:text-gray-700 hover:bg-gray-50">
        Plugins (<?php echo $numPlugins; ?>)
      </button>
      <button class="px-3 py-2 text-sm font-medium text-gray-500 rounded-md hover:text-gray-700 hover:bg-gray-50">
        Resource Packs (<?php echo $numResourcepacks; ?>)
      </button>
    </nav>
  </div>
</div>

<div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
  <?php foreach ($datapacks as $datapack): ?>
  <div class="bg-white overflow-hidden shadow-sm rounded-lg">
    <div class="relative pb-[56.25%]">
      <img src="<?php echo $datapack['imagem']; ?>" alt="<?php echo $datapack['nome']; ?>" class="absolute h-full w-full object-cover">
    </div>
    <div class="p-4">
      <h3 class="text-lg font-semibold text-gray-900"><?php echo $datapack['nome']; ?></h3>
      <p class="mt-1 text-sm text-gray-500"><?php echo $datapack['tipo']; ?></p>
      <div class="mt-4">
        <a href="<?php echo $datapack['link']; ?>" target="_blank" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
          Ver mais
        </a>
      </div>
    </div>
  </div>
  <?php endforeach; ?>
</div>

<div class="hidden mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
  <?php foreach ($plugins as $plugin): ?>
  <div class="bg-white overflow-hidden shadow-sm rounded-lg">
    <div class="relative pb-[56.25%]">
      <img src="<?php echo $plugin['imagem']; ?>" alt="<?php echo $plugin['nome']; ?>" class="absolute h-full w-full object-cover">
    </div>
    <div class="p-4">
      <h3 class="text-lg font-semibold text-gray-900"><?php echo $plugin['nome']; ?></h3>
      <p class="mt-1 text-sm text-gray-500"><?php echo $plugin['tipo']; ?></p>
      <div class="mt-4">
        <a href="<?php echo $plugin['link']; ?>" target="_blank" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
          Ver mais
        </a>
      </div>
    </div>
  </div>
  <?php endforeach; ?>
</div>

<div class="hidden mt-8 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
  <?php foreach ($resourcepacks as $resourcepack): ?>
  <div class="bg-white overflow-hidden shadow-sm rounded-lg">
    <div class="relative pb-[56.25%]">
      <img src="<?php echo $resourcepack['imagem']; ?>" alt="<?php echo $resourcepack['nome']; ?>" class="absolute h-full w-full object-cover">
    </div>
    <div class="p-4">
      <h3 class="text-lg font-semibold text-gray-900"><?php echo $resourcepack['nome']; ?></h3>
      <p class="mt-1 text-sm text-gray-500"><?php echo $resourcepack['tipo']; ?></p>
      <div class="mt-4">
        <a href="<?php echo $resourcepack['link']; ?>" target="_blank" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
          Ver mais
        </a>
      </div>
    </div>
  </div>
  <?php endforeach; ?>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Get all resource sections
  const datapacks = document.querySelector('[aria-current="page"]').parentElement.nextElementSibling;
  const plugins = document.querySelector('[aria-current="page"]').parentElement.nextElementSibling.nextElementSibling;
  const resourcePacks = document.querySelector('[aria-current="page"]').parentElement.nextElementSibling.nextElementSibling.nextElementSibling;

  // Get all tab buttons
  const tabs = document.querySelectorAll('button[aria-current]');

  // Add click event listeners to tabs
  tabs.forEach((tab, index) => {
    tab.addEventListener('click', () => {
      // Remove active state from all tabs
      tabs.forEach(t => {
        t.setAttribute('aria-current', 'false');
        t.classList.remove('text-indigo-600', 'bg-indigo-50');
        t.classList.add('text-gray-500');
      });

      // Add active state to clicked tab
      tab.setAttribute('aria-current', 'page');
      tab.classList.remove('text-gray-500');
      tab.classList.add('text-indigo-600', 'bg-indigo-50');

      // Hide all sections
      [datapacks, plugins, resourcePacks].forEach(section => {
        section.classList.add('hidden');
      });

      // Show selected section
      const sections = [datapacks, plugins, resourcePacks];
      sections[index].classList.remove('hidden');
    });
  });

  // Mobile dropdown handling
  const mobileSelect = document.getElementById('resourceTabs');
  mobileSelect.addEventListener('change', (e) => {
    const selectedIndex = e.target.selectedIndex;
    tabs[selectedIndex].click();
  });
});
</script>
